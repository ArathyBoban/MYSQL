CREATE DATABASE LIBRARY;
USE LIBRARY;
CREATE TABLE BRANCH(BRANCH_NO INT PRIMARY KEY,
	MANAGER_ID INT,
    BRANCH_ADDRESS CHAR(15),
    CONTACT_NO INT);
INSERT INTO BRANCH VALUES(1,100,'XYZ',230230);
INSERT INTO BRANCH VALUES(2,101,'UVW',330330);
INSERT INTO BRANCH VALUES(3,102,'RST',430430);
INSERT INTO BRANCH VALUES(4,103,'OPQ',530530);
INSERT INTO BRANCH VALUES(5,104,'LMN',630630);
INSERT INTO BRANCH VALUES(6,105,'IJK',730730);
INSERT INTO BRANCH VALUES(7,106,'FGH',830830);
INSERT INTO BRANCH VALUES(8,107,'CDE',930930);
SELECT * FROM BRANCH;
    
CREATE TABLE EMPLOYEE(EMP_ID INT PRIMARY KEY,
	EMP_NAME VARCHAR(25),
    POSITION VARCHAR(20),
    SALARY INT,
    BRANCH_NO INT,FOREIGN KEY (BRANCH_NO) REFERENCES BRANCH(BRANCH_NO));
INSERT INTO EMPLOYEE VALUES(200,'ATHARV VARMA','MANAGER',50000,1);
INSERT INTO EMPLOYEE VALUES(201,'BHANU PRIYA','ASSISTANT',35000,2);
INSERT INTO EMPLOYEE VALUES(202,'CLARIE WILSON','CLERK',25000,3);
INSERT INTO EMPLOYEE VALUES(203,'DEVIS DANIEL','ADMIN',40000,4);
INSERT INTO EMPLOYEE VALUES(204,'ELEENA JOHN','ASSISTANT',35000,5);
INSERT INTO EMPLOYEE VALUES(205,'FATHIMA NAZEEM','CLERK',25000,6);
INSERT INTO EMPLOYEE VALUES(206,'GANGA KUMAR','HR',45000,7);
INSERT INTO EMPLOYEE VALUES(207,'HIMESH MENON','HR',45000,8);
SELECT * FROM EMPLOYEE;
    
CREATE TABLE BOOKS(ISBN INT PRIMARY KEY,
	BOOK_TITLE VARCHAR(20),
    CATEGORY VARCHAR(25),
    RENTAL_PRICE INT,
    STATUS CHAR(3),
    AUTHOR VARCHAR(15),
    PUBLISHER VARCHAR(25));
INSERT INTO BOOKS VALUES(300,'JANE_EYRE','AUTOBIOGRAPHY',250,'YES','CHARLOTTE','SMITH');
INSERT INTO BOOKS VALUES(301,'EMMA','NOVEL',300,'YES','JANE_AUSTEN','JOHN_MURRAY');
INSERT INTO BOOKS VALUES(302,'BELOVED','NOVEL',550,'NO','TONI_MORRISON','ALFRED');
INSERT INTO BOOKS VALUES(303,'DUBLINERS','STORIES',350,'YES','JAMES_JOYCE','GRAND_RICHARDS');
INSERT INTO BOOKS VALUES(304,'REBECCA','NOVEL',450,'NO','DAPHNE','VICTOR');
INSERT INTO BOOKS VALUES(305,'THE_HOBBIT','FANTACY',400,'YES','TOLKEIN','GEORGE_ALLEN');
INSERT INTO BOOKS VALUES(306,'1984','FICTION',500,'NO','GEORGE','SECKER');
INSERT INTO BOOKS VALUES(307,'FRANKENSTEIN','NOVEL',200,'YES','MARY_SHELLEY','LACKINGTON');
SELECT * FROM BOOKS;
    
CREATE TABLE CUSTOMER(CUSTOMER_ID INT PRIMARY KEY,
	CUSTOMER_NAME VARCHAR(25),
	CUSTOMER_ADDRESS VARCHAR(25),
	REG_DATE DATE);
INSERT INTO CUSTOMER VALUES(400,'ADAM_JOHN','MELEPPIL','2024-02-05');
INSERT INTO CUSTOMER VALUES(401,'BIBIN_BABU','FALCON','2024-08-21');
INSERT INTO CUSTOMER VALUES(402,'CLARA_MARY','HEAVEN','2024-10-25');
INSERT INTO CUSTOMER VALUES(403,'DEEPA_KUMARI','VALAVIL','2024-09-10');
INSERT INTO CUSTOMER VALUES(404,'FAROOQ_RAHMAN','ARAKKAL','2024-12-30');
INSERT INTO CUSTOMER VALUES(405,'GIREESH_MENON','MALAYIL','2024-11-25');
INSERT INTO CUSTOMER VALUES(406,'HEMANSHI_DUTHA','DREAM','2021-01-01');
INSERT INTO CUSTOMER VALUES(407,'JACOB_FRANCIS','BATHLAHEM','2020-05-05');
SELECT * FROM CUSTOMER;

CREATE TABLE ISSUE_STATUS(ISSUE_ID INT PRIMARY KEY,
	ISSUE_CUST INT,FOREIGN KEY (ISSUE_CUST) REFERENCES CUSTOMER(CUSTOMER_ID),
    ISSUED_BOOK_NAME VARCHAR(25),
    ISSUE_DATE DATE,
    ISBN_BOOK INT, FOREIGN KEY(ISBN_BOOK) REFERENCES BOOKS(ISBN));
INSERT INTO ISSUE_STATUS VALUES(500,400,'BELOVED','2024-03-20',302);
INSERT INTO ISSUE_STATUS VALUES(501,401,'JANE_EYRE','2024-08-30',300);
INSERT INTO ISSUE_STATUS VALUES(502,402,'DUBLINERS','2024-10-25',303);
INSERT INTO ISSUE_STATUS VALUES(503,403,'THE_HOBBIT','2024-10-28',305);
INSERT INTO ISSUE_STATUS VALUES(504,404,'FRANKENSTEIN','2024-12-30',307);
INSERT INTO ISSUE_STATUS VALUES(505,405,'1984','2024-12-01',306);
INSERT INTO ISSUE_STATUS VALUES(506,406,'EMMA','2021-03-27',301);
INSERT INTO ISSUE_STATUS VALUES(507,407,'REBECCA','2021-11-17',304);
SELECT * FROM ISSUE_STATUS;
    
CREATE TABLE RETURN_STATUS(RETURN_ID INT PRIMARY KEY,
	RETURN_CUST INT,
    RETURN_BOOK_NAME VARCHAR(25),
    RETURN_DATE DATE,
    ISBN_BOOK2 INT, FOREIGN KEY (ISBN_BOOK2) REFERENCES BOOKS(ISBN));
INSERT INTO RETURN_STATUS VALUES(600,500,'BELOVED','2024-04-01',302);
INSERT INTO RETURN_STATUS VALUES(601,503,'THE_HOBBIT','2024-09-05',305);
INSERT INTO RETURN_STATUS VALUES(602,504,'1984','2024-12-31',306);
INSERT INTO RETURN_STATUS VALUES(603,501,'FRANKENSTEIN','2024-09-01',307);
INSERT INTO RETURN_STATUS VALUES(604,502,'JANE_EYRE','2024-11-07',300);
INSERT INTO RETURN_STATUS VALUES(605,505,'DUBLINERS','2024-12-19',303);
INSERT INTO RETURN_STATUS VALUES(606,500,'REBECCA','2024-04-16',304);
INSERT INTO RETURN_STATUS VALUES(607,502,'EMMA','2024-11-06',301);
SELECT * FROM RETURN_STATUS;
SELECT BOOK_TITLE, CATEGORY, RENTAL_PRICE FROM BOOKS;
SELECT EMP_NAME, SALARY FROM EMPLOYEE ORDER BY SALARY DESC;
SELECT ISSUED_BOOK_NAME,ISSUE_CUST FROM ISSUE_STATUS;
SELECT DISTINCT CATEGORY,COUNT(*) AS NUMBER FROM BOOKS GROUP BY CATEGORY;
SELECT EMP_NAME,POSITION FROM EMPLOYEE WHERE SALARY>40000;
SELECT CUSTOMER_NAME FROM CUSTOMER WHERE REG_DATE < '2022-01-01';
SELECT BRANCH_NO,COUNT(*) AS NUMBER_OF_EMP FROM EMPLOYEE GROUP BY BRANCH_NO;
SELECT ISSUE_CUST FROM ISSUE_STATUS WHERE ISSUE_DATE<'2024-06-01';
SELECT BOOK_TITLE FROM BOOKS WHERE CATEGORY='STORIES';
SELECT BRANCH_NO, COUNT(*) AS NO_OF_EMP FROM EMPLOYEE GROUP BY EMP_ID;
SELECT BOOK_TITLE FROM BOOKS WHERE RENTAL_PRICE>500;
SELECT ISSUE_CUST,ISSUED_BOOK_NAME FROM ISSUE_STATUS WHERE ISSUED_BOOK_NAME='BELOVED';
SELECT B.BRANCH_NO, B.BRANCH_ADDRESS,E.BRANCH_NO,E.EMP_NAME FROM BRANCH B LEFT JOIN EMPLOYEE E 
ON B.BRANCH_NO=E.BRANCH_NO;

 




